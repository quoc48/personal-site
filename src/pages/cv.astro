---
import BaseLayout from '../layouts/BaseLayout.astro';

const pdfPath = '/Quoc-CV.pdf';
const downloadPath = '/Quoc-CV.pdf';
---

<BaseLayout
  title="My CV - Quoc Phan"
  description="View and download Quoc Phan's CV - Product Designer with expertise in enterprise applications."
>
  <section class="flex flex-col gap-6 px-5 md:px-[50px] py-6 md:py-8">
    <!-- Download Button - More prominent on mobile -->
    <div class="flex flex-col md:flex-row md:justify-end w-full gap-3">
      <a
        href={downloadPath}
        download="Quoc-Phan-CV.pdf"
        class="inline-flex items-center justify-center gap-2 px-5 py-3 md:py-2.5 bg-[#2c2c2c] text-white font-lato font-medium text-base rounded-lg hover:bg-[#1a1a1a] transition-colors"
      >
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Download My CV
      </a>
      
      <!-- Mobile hint -->
      <p class="md:hidden text-sm text-[#757575] font-lato text-center">
        For the best viewing experience, download the PDF
      </p>
    </div>

    <!-- PDF Viewer -->
    <div class="w-full">
      <!-- Mobile: Google Docs Viewer -->
      <iframe
        id="pdf-viewer-mobile"
        class="md:hidden w-full rounded-lg border border-gray-200"
        style="height: 70vh; min-height: 500px;"
        title="Quoc Phan's CV"
      ></iframe>
      
      <!-- Desktop: Native PDF with reasonable height -->
      <iframe
        id="pdf-viewer-desktop"
        src={`${pdfPath}#toolbar=1&navpanes=0&view=FitH`}
        class="hidden md:block w-full rounded-lg border border-gray-200"
        style="aspect-ratio: 210 / 260;"
        title="Quoc Phan's CV"
      ></iframe>
    </div>
  </section>
</BaseLayout>

<script>
  function initPdfViewer() {
    const mobileViewer = document.getElementById('pdf-viewer-mobile') as HTMLIFrameElement;
    if (!mobileViewer) return;
    
    // Set mobile viewer source with Google Docs Viewer
    const pdfUrl = '/Quoc-CV.pdf';
    const fullUrl = window.location.origin + pdfUrl;
    mobileViewer.src = `https://docs.google.com/viewer?url=${encodeURIComponent(fullUrl)}&embedded=true`;
  }

  document.addEventListener('DOMContentLoaded', initPdfViewer);
  document.addEventListener('astro:page-load', initPdfViewer);
  
  if (document.readyState === 'complete' || document.readyState === 'interactive') {
    setTimeout(initPdfViewer, 0);
  }
</script>
